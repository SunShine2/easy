<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>js\core.js - EasyTouch</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.5.1&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="..&#x2F;assets/favicon.png">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;combo?3.5.1&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="..&#x2F;assets/css/logo.png" title="EasyTouch"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.0.1</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/$.EasyTouch.html">$.EasyTouch</a></li>
            
                <li><a href="..&#x2F;classes/$.EasyTouch.Model.html">$.EasyTouch.Model</a></li>
            
                <li><a href="..&#x2F;classes/$.EasyTouch.ModelList.html">$.EasyTouch.ModelList</a></li>
            
                <li><a href="..&#x2F;classes/$.EasyTouch.Page.html">$.EasyTouch.Page</a></li>
            
                <li><a href="..&#x2F;classes/$.EasyTouch.View.html">$.EasyTouch.View</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="..&#x2F;modules/EasyTouch.html">EasyTouch</a></li>
            
                <li><a href="..&#x2F;modules/EasyTouch-Model.html">EasyTouch-Model</a></li>
            
                <li><a href="..&#x2F;modules/EasyTouch-ModelList.html">EasyTouch-ModelList</a></li>
            
                <li><a href="..&#x2F;modules/EasyTouch-Page.html">EasyTouch-Page</a></li>
            
                <li><a href="..&#x2F;modules/EasyTouch-View.html">EasyTouch-View</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: js\core.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
&#x2F;**
 * EasyTouch
 * @author: youxiao@alibaba-inc.com
 * @version: 0.0.1
 * @module EasyTouch
 * @uses EasyTouch-Page
 * @review
 *  1. 建立一个Logger机制
 *  2. 监听backbutton事件，如果是在子应用可以回到父应用
 *
 *&#x2F;
;(function(){
    var
        &#x2F;**
         &#x60;app.navPage&#x60;或者&#x60;app.pageBack&#x60;开始前促发
         @event pagebeforechange
         @param {Object} e event object from custom-event
         @param {Object} params
         @param {String} params.from page id of prev page
         @param {String|Undefined} params.to page id of next page
         @param {Object|Undefined} params.data the data when you call &#x60;app.navPage&#x60; or &#x60;app.pageBack&#x60;
         @param {String|Undefined} params.anim the animation name
         **&#x2F;
        EVN_APP_PAGE_BEFORE_CHANGE = &#x27;pagebeforechange&#x27;,
        &#x2F;**
         页面切换完成时促发，包括&#x60;app.navPage&#x60;和&#x60;app.pageBack&#x60;

             var app = new EasyTouch({...});
                 app.bind(&#x27;pagechange&#x27;, function(e, params){
                 var fromPage = this.getPage(params.from);
             }, app);

         @event pagechange
         @param {Object} e event object from custom-event
         @param {Object} params
         @param {String} params.from page id of prev page
         @param {String|Undefined} params.to page id of next page
         @param {Object|Undefined} params.data the data when you call &#x60;app.navPage&#x60; or &#x60;app.pageBack&#x60;
         @param {String|Undefined} params.anim the animation name
         **&#x2F;
        EVN_APP_PAGE_CHANGE = &#x27;pagechange&#x27;,
        &#x2F;**
         &#x60;app.pageBack&#x60;开始前促发
         @event pagebeforeback
         @param {Object} e event object from custom-event
         @param {Object} params
         @param {String} params.from page id of prev page
         @param {String} params.to page id of next page
         @param {Object|Undefined} params.data the data when you call &#x60;app.pageBack&#x60;
         @param {String|Undefined} params.anim the animation name
         **&#x2F;
        EVN_APP_PAGE_BEFORE_BACK = &#x27;pagebeforeback&#x27;,
        &#x2F;**
         &#x60;app.pageBack&#x60;完成时促发
         @event pageback
         @param {Object} e event object from custom-event
         @param {Object} params
         @param {String} params.from page id of prev page
         @param {String} params.to page id of next page
         @param {Object|Undefined} params.data the data when you call &#x60;app.pageBack&#x60;
         @param {String|Undefined} params.anim the animation name
         **&#x2F;
        EVN_APP_PAGE_BACK = &#x27;pageback&#x27;,
        &#x2F;**
         &#x60;app.navPage&#x60;完成时促发
         @event pagenav
         @param {Object} e event object from custom-event
         @param {Object} params
         @param {String} params.from page id of prev page
         @param {String} params.to page id of next page
         @param {Object|Undefined} params.data the data when you call &#x60;app.navPage&#x60;
         @param {String|Undefined} params.anim the animation name
         **&#x2F;
        EVN_APP_PAGE_NAV = &#x27;pagenav&#x27;,
        &#x2F;**
         &#x60;app.navPage&#x60;开始前促发
         @event pagebeforenav
         @param {Object} e event object from custom-event
         @param {Object} params
         @param {String} params.from page id of prev page
         @param {String|Undefined} params.to page id of next page
         @param {Object|Undefined} params.data the data when you call &#x60;app.navPage&#x60;
         @param {String|Undefined} params.anim the animation name
         **&#x2F;
        EVN_APP_BEFORE_PAGE_NAV = &#x27;pagebeforenav&#x27;,
        &#x2F;**
         异步获取页面前促发
         @event pagebeforeload
         @param {Object} e event object from custom-event
         @param {Object} params
         @param {String} params.id page id of prev page
         @param {Object} params.data page data for the target page
         **&#x2F;
        EVN_APP_BEFORE_PAGE_LOAD = &#x27;pagebeforeload&#x27;,
        &#x2F;**
         异步获取页面完成后促发
         @event pageload
         @param {Object} e event object from custom-event
         @param {Object} params
         @param {String} params.id page id of prev page
         @param {Object} params.data page data for the target page
         **&#x2F;
        EVN_APP_PAGE_LOAD = &#x27;pageload&#x27;,
        &#x2F;**
         异步获取页面失败时促发
         @event pageloadfailed
         @param {Object} e event object from custom-event
         @param {Object} params
         @param {String} params.id page id of prev page
         @param {Object} params.data page data for the target page
         **&#x2F;
        EVN_APP_PAGE_LOAD_ERROR = &#x27;pageloadfailed&#x27;,
        &#x2F;**
         * 退出应用时，子应用促发
         * @event exit
         * @param {Object} e event object from custom-event
         * @param {Object} params
         *      @param {String} params.id the child app&#x27;s id
         *      @param {Object} data data for the parent app
         *&#x2F;
        EVN_APP_EXIT = &#x27;appexit&#x27;,
        &#x2F;**
         * 第二次&#x60;app.navApp&#x60;到子应用时，子应用促发
         * @event reset
         * @param {Object} e event object from custom-event
         * @param {Object} params
         *      @param {String} params.id the target app&#x27;s id
         *      @param {Object} data data for the target app
         *&#x2F;
        EVN_APP_RESET = &#x27;appreset&#x27;,
        &#x2F;**
         * 从子应用回到宿主应用时，宿主应用促发
         * @event appback
         * @param {Object} e event object from custom-event
         * @param {Object} params
         *      @param {String} params.id the child app&#x27;s id
         *      @param {Object} data when the child app call &#x60;app.exit&#x60;
         *&#x2F;
        EVN_APP_BACK = &#x27;appback&#x27;,
        &#x2F;**
         * &#x60;app.navApp&#x60;后促发
         * @event appnav
         * @param {Object} e event object from custom-event
         * @param {Object} params
         *      @param {String} params.id the target app&#x27;s id
         *      @param {Object} params.data the data for the target app
         *&#x2F;
        EVN_APP_NAV = &#x27;appnav&#x27;,
        &#x2F;**
         * &#x60;app.navApp&#x60;前促发
         * @event appbeforenav
         * @param {Object} e event object from custom-event
         * @param {Object} params
         *      @param {String} params.id the target app&#x27;s id
         *      @param {Object} params.data the data for the target app
         *&#x2F;
        EVN_APP_BEFORE_NAV = &#x27;appbeforenav&#x27;,
        &#x2F;**
         * 第一次加载子应用时促发
         * @event appbeforeload
         * @param {Object} e event object from custom-event
         * @param {Object} params
         *      @param {String} params.id the target app&#x27;s id
         *      @param {Object} params.data the data for the target app
         *&#x2F;
        EVN_APP_BEFORE_LOAD = &#x27;appbeforeload&#x27;,
        &#x2F;**
         * 第一次加载子应用完成时促发
         * @event appload
         * @param {Object} e event object from custom-event
         * @param {Object} params
         *      @param {String} params.id the target app&#x27;s id
         *      @param {Object} params.data the data for the target app
         *&#x2F;
        EVN_APP_LOAD = &#x27;appload&#x27;,
        &#x2F;**
         * 加载子应用失败时促发
         * @event apploadfailed
         * @param {Object} e event object from custom-event
         * @param {Object} params
         *      @param {String} params.id the target app&#x27;s id
         *      @param {Object} params.data the data for the target app
         *&#x2F;
        EVN_APP_LOAD_ERROR = &#x27;apploadfailed&#x27;,
        TIME_WAIT_FOR_RENDER = 0,
        TIME_WAIT_FOR_ANIMATION = 100,
        CLASS_APP = &#x27;easytouch&#x27;,
        CLASS_PREFIX = &#x27;et-&#x27;,
        SESSION_HISTORY = &#x27;easytouch:page_history&#x27;,
        MARK_CHILD_APP = &#x27;easytouch-childapp&#x27;,
        REGEX_HTML_ADRESS = &#x2F;^[\S]+\.html$&#x2F;i,
        REGEX_SELECTOR = &#x2F;^[a-zA-Z0-9\.#&gt;\[\]&#x27;&quot;=\s~\*\+:\(\)\-\$\^]+$&#x2F;i;

    var reverseAnimation = function(animation, regex){
        var _reverse = function(anim){
            var opposites={
                &#x27;Top&#x27; : &#x27;Bottom&#x27;,
                &#x27;Bottom&#x27; : &#x27;Top&#x27;,
                &#x27;Left&#x27; : &#x27;Right&#x27;,
                &#x27;Right&#x27; : &#x27;Left&#x27;,
                &#x27;In&#x27; : &#x27;Out&#x27;,
                &#x27;Out&#x27; : &#x27;In&#x27;
            };
            return opposites[anim] || anim;
        };
        regex = regex || &#x2F;Left|Right|Top|Bottom|In|Out&#x2F;g;
        return animation.replace(regex, _reverse);
    };

    var DelegateEvents = function(){};
    DelegateEvents.prototype.delegateEvents = function(events){
        if (!events){
            return this;
        }
        var _this = this;
        this.undelegateEvents();
        $.each(events, function(selector, methods){
            $.each(methods, function(type, handle){
                if (typeof handle !== &#x27;function&#x27;){
                    handle = _this[handle];
                }
                var proxyfn = function(e){
                    handle.apply(_this, [e, this]);
                };
                type += &#x27;.delegateEvents&#x27; + _this.id;
                if (selector === &#x27;&#x27;) {
                    _this.$el.bind(type, proxyfn);
                } else {
                    _this.$el.delegate(selector, type, proxyfn);
                }
            });
        });
        return this;
    };
    DelegateEvents.prototype.undelegateEvents = function() {
        this.$el.unbind(&#x27;.delegateEvents&#x27; + this.id);
        return this;
    };

    var Loading = function(){};
    Loading.prototype.showLoading = function(options){
        options = options || {};
        var msg = options.msg || &#x27;&#x27;,
            modal = !!options.modal,
            className = CLASS_PREFIX+&#x27;load&#x27;,
            $load = this.$el.children(&#x27;.&#x27;+className);
        if($load.length){
            $load.text(msg).data(&#x27;modal&#x27;, modal).show();
        }else{
            this.$el.append(&#x27;&lt;div class=&quot;&#x27;+className+&#x27;&quot; data-modal=&quot;&#x27;+modal+&#x27;&quot;&gt;&lt;&#x2F;div&gt;&#x27;);
        }

        return this;
    };
    Loading.prototype.hideLoading = function(){
        this.$el.children(&#x27;.&#x27;+CLASS_PREFIX+&#x27;load&#x27;).hide();
        return this;
    };

    &#x2F;**
     EasyTouch，为移动设备设计的UI框架。使用方法：用&#x60;$.EasyTouch.extend&#x60;方法扩展一个App类，然后初始化。&#x60;extend&#x60;的具体说明，请看&#x60;$.EasyTouch.extend&#x60;；参数&#x60;pages&#x60;的说明请看&#x60;$.EasyTouch.Page&#x60;：

         var App = $.EasyTouch.extend({
             id: xxx,
             container: xxx,
             pages: {
                ...
             },
             apps: {
                ...
             },
             events: {
                ...
             }
         });

         new App();

     @class $.EasyTouch
     @extends $.Base
     @constructor
     **&#x2F;
    $.EasyTouch = $.Base.build(&#x27;$.EasyTouch&#x27;, {
        &#x2F;**
         * [需要重写]应用id
         * @property id
         * @type String
         * @default &#x27;easytouch&#x27;
         * @optional
         *&#x2F;
        id: &#x27;easytouch&#x27;,
        &#x2F;**
         * [需要重写]容器
         * @property container
         * @type HTMLElement|Node|String
         * @default &#x27;body&#x27;
         * @optional
         *&#x2F;
        container: &#x27;body&#x27;,
        &#x2F;**
         * [需要重写]加载页面和应用时是否显示加载中提示
         * @property ifShowLoading
         * @type Boolean
         * @default true
         * @optional
         *&#x2F;
        ifShowLoading: true,
        &#x2F;**
         * [需要重写]页面切换时的默认动画
         * @property defaultAnimation
         * @type String
         * @default undefined
         * @optional
         *&#x2F;
        defaultAnimation: undefined,
        &#x2F;**
         * [需要重写]代理的事件列表，&#x60;handler&#x60;可是一个字符串也可以是一个&#x60;function&#x60;，当是字符串时，将访问&#x60;this[&#x27;nav&#x27;]&#x60;
         *
         *      {
         *          &#x27;#contariner header&#x27;: {
         *              tap: &#x27;nav
         *          },
         *          &#x27;#contariner&#x27;: {
         *              tap: function(){},
         *          },
         *          &#x2F;&#x2F;当选择器是空的时，为本身
         *          &#x27;&#x27;: function(){
         *              tap: function(){}
         *          }
         *      }
         *
         * @property events
         * @type Object
         * @optional
         *&#x2F;
        events: {},
        &#x2F;**
         * [需要重写]Page原型
         * @property pages
         * @type Object
         * @required
         *&#x2F;
        pages: {},
        &#x2F;**
         * [需要重写]子应用的配置
         *
         *      {
         *          &#x27;hongbao&#x27;: &#x27;http:&#x2F;&#x2F;cloudappfile.aliapp.com&#x2F;prod&#x2F;app_4&#x2F;7184_b6b&#x2F;hongbao&#x2F;&#x27;
         *      }
         *
         * @property apps
         * @type Object
         * @optional
         *&#x2F;
        apps: {},
        &#x2F;**
         * 容器（原生dom）
         * @property el
         * @type HTMLElement
         * @optional
         *&#x2F;
        el: undefined,
        &#x2F;**
         * 容器（Zepto对象）
         * @property $el
         * @type Node
         * @optional
         *&#x2F;
        $el: undefined,
        &#x2F;**
         * Page实例
         * @property _pages
         * @type Object
         * @private
         *&#x2F;
        _pages: {},
        &#x2F;**
         * 子应用
         * @property _apps
         * @type Object
         * @private
         *&#x2F;
        _apps: {},
        &#x2F;**
         * 页面跳转的历史记录
         * @property _history
         * @type Array
         * @private
         *&#x2F;
        _history: [],
        &#x2F;**
         * 宿主应用
         * @property host
         * @type Object
         * @private
         *&#x2F;
        host: undefined,
        &#x2F;**
         * 宿主应用是否处于可视状态
         * @property _active
         * @type Boolean
         * @private
         *&#x2F;
        _active: true,
        &#x2F;**
         * 构造函数
         * @method initializer
         * @private
         * @param options 应用启动参数
         *&#x2F;
        initializer: function(options){
            &#x2F;&#x2F;通过url上的标志判断是否时子应用
            if(window.location.href.indexOf(MARK_CHILD_APP) !== -1){
                this.host = {
                    window: window.parent
                };
                &#x2F;&#x2F;通知宿主应用，应用加载成功
                this.host.window.postMessage({
                    id: this.id,
                    event: EVN_APP_LOAD
                }, &#x27;*&#x27;);
                try{
                    options = JSON.parse(decodeURIComponent(window.location.hash.substring(MARK_CHILD_APP.length + 2)));
                    &#x2F;&#x2F;清楚hash，防止刷新的时候不能回到上一次访问的页面
                    &#x2F;&#x2F;window.location.hash = &#x27;&#x27;;
                }catch(ex){}
            }

            console.log(&#x27;[EasyTouch] initializer&#x27;, options);

            var _this = this;
            this.history = this.history();
            this.$el = typeof this.container === &#x27;string&#x27;?$(this.container):this.container;
            this.$el.addClass(CLASS_APP);
            this.el = this.$el[0];
            this.delegateEvents(this.events);

            &#x2F;&#x2F;yunos event
            var postChildEvents = function(event){
                $.each(_this._apps, function(k, v){
                    v.window.postMessage({
                        id: k,
                        event: event
                    }, &#x27;*&#x27;);
                });
            };
            $(document).bind(&#x27;resume&#x27;, function(e){
                postChildEvents(e.type);
                _this.resume();
            }).bind(&#x27;pause&#x27;, function(e){
                postChildEvents(e.type);
                _this.pause();
            }).bind(&#x27;backbutton&#x27;, function(e){
                postChildEvents(e.type);
                if(_this._active){
                    _this.pageBack();
                }
            }).bind(&#x27;resetbutton&#x27;, function(e){
                postChildEvents(e.type);
                _this.resetbutton();
            });

            &#x2F;&#x2F;loading
            if(this.ifShowLoading){
                this.bind(EVN_APP_BEFORE_PAGE_LOAD, function(){
                    _this.showLoading();
                });
                this.bind(EVN_APP_PAGE_LOAD, function(){
                    _this.hideLoading();
                });
                this.bind(EVN_APP_PAGE_LOAD_ERROR, function(){
                    _this.hideLoading();
                });
                this.bind(EVN_APP_BEFORE_LOAD, function(){
                    _this.showLoading();
                });
                this.bind(EVN_APP_LOAD, function(){
                    _this.hideLoading();
                });
                this.bind(EVN_APP_LOAD_ERROR, function(){
                    _this.hideLoading();
                });
            }

            &#x2F;&#x2F;load fail
            this.bind(EVN_APP_LOAD_ERROR, function(e, data){
                var app = this._apps[data.id];
                if(app){
                    app.$el.remove();
                    delete this._apps[data.id];
                }
            }, this);
            this.bind(EVN_APP_PAGE_LOAD_ERROR, function(e, data){
                delete this._pages[data.id];
            }, this);

            &#x2F;&#x2F;child app message
            window.addEventListener(&#x27;message&#x27;, function(e){
                console.log(&#x27;[EasyTouch] onmessage&#x27;, e);

                var data = e.data,
                    event = data.event;
                if(event === EVN_APP_EXIT){
                    if(_this._apps[data.id]){
                        _this._apps[data.id].$el.hide();
                        _this._active = true;
                        _this.trigger(EVN_APP_BACK, data);
                    }
                }else if(event === EVN_APP_RESET){
                    _this.reset(data.data);
                    _this.trigger(EVN_APP_RESET, data);
                }else if(event === EVN_APP_LOAD){
                    if(_this._apps[data.id]){
                        _this._apps[data.id].loaded = true;
                    }
                }else if([&#x27;resume&#x27;, &#x27;pause&#x27;, &#x27;backbutton&#x27;, &#x27;resetbutton&#x27;].indexOf(event) !== -1){
                    $(document).trigger(event);
                }
            });

&#x2F;&#x2F;        this.bind(EVN_APP_PAGE_CHANGE, function(e, data){
&#x2F;&#x2F;            var hash = data.to;
&#x2F;&#x2F;            if(data.data){
&#x2F;&#x2F;                hash += &#x27;=&#x27; + JSON.stringify(data.data);
&#x2F;&#x2F;            }
&#x2F;&#x2F;            window.location.hash = hash;
&#x2F;&#x2F;        });

            this.init(options);
        },
        &#x2F;**
         * [需要重写]Init lifecycle method, invoked during construction. Fires the init event prior to setting up attributes and invoking initializers for the class hierarchy.
         * @method init
         * @param {Object} options
         *&#x2F;
        init: function(options){
            console.log(&#x27;[EasyTouch] init&#x27;, arguments);
        },
        &#x2F;**
         * [需要重写]作为子应用第二次访问被访问时执行
         * @method reset
         * @param {Object} options
         *&#x2F;
        reset: function(options){
            console.log(&#x27;[EasyTouch] reset&#x27;, arguments);
        },
        &#x2F;**
         * [需要重写]YunOS的resume事件监听，halo会在&#x60;document&#x60;上促发该事件
         * @method resume
         *&#x2F;
        resume: function(){
            console.log(&#x27;[EasyTouch] resume&#x27;, arguments);
        },
        &#x2F;**
         * [需要重写]YunOS的pause事件监听，halo会在&#x60;document&#x60;上促发该事件
         * @method pause
         *&#x2F;
        pause: function(){
            console.log(&#x27;[EasyTouch] pause&#x27;, arguments);
        },
        &#x2F;**
         * 按云键，默认退出应用，halo会在&#x60;document&#x60;上促发该事件
         * @method resetbutton
         * @chainable
         *&#x2F;
        resetbutton: function(){
            console.log(&#x27;[EasyTouch] resetbutton&#x27;, arguments);
            this.exit();
            return this;
        },
        &#x2F;**
         * 退出应用，当子应用调用该方法时，可是携带参数，宿主应用会在&#x60;back&#x60;事件中获得这些参数
         * @method exit
         * @param {Object} data the data for the parent app
         * @chainable
         *&#x2F;
        exit: function(data){
            console.log(&#x27;[EasyTouch] exit&#x27;, arguments);

            if(this.host){
                var params = {
                    id: this.id,
                    data: data,
                    event: EVN_APP_EXIT
                };
                this.host.window.postMessage(params, &#x27;*&#x27;);
                this.trigger(EVN_APP_EXIT, params);
            }else{
                navigator.app.exit();
            }

            return this;
        },
        &#x2F;**
         * @method navApp
         * @param {String} id the target app&#x27;s id
         * @param {Object} data data for the target app
         * @chainable
         *&#x2F;
        navApp: function(id, data){
            var _this = this,
                _data = $.extend({}, data);

            data = {
                id: id,
                data: data
            };

            this.trigger(EVN_APP_BEFORE_NAV, data);

            if(this._apps[id]){
                this._apps[id].window.postMessage({
                    id: id,
                    event: EVN_APP_RESET,
                    data: _data
                }, &#x27;*&#x27;);
                this._apps[id].$el.show();
            }else{
                var url = this.apps[id];
                try{
                    url += &#x27;#&#x27; + MARK_CHILD_APP + &#x27;=&#x27; + encodeURIComponent(JSON.stringify(_data));
                }catch(ex){}
                this.trigger(EVN_APP_BEFORE_LOAD, data);
                var iframe = $(&#x27;&lt;iframe src=&quot;&#x27;+url+&#x27;&quot; class=&quot;&#x27;+CLASS_PREFIX+&#x27;app&quot;&gt;&lt;&#x2F;iframe&gt;&#x27;).bind(&#x27;load&#x27;, function(e){
                    setTimeout(function(){
                        if(_this._apps[id].loaded){
                            _this.trigger(EVN_APP_LOAD, data);
                        }else{
                            _this.trigger(EVN_APP_LOAD_ERROR, data);
                        }
                    }, 500);
                }).bind(&#x27;error&#x27;, function(e){
                        _this.trigger(EVN_APP_LOAD_ERROR, data);
                    }).css({
                        height: window.screen.height,
                        width: window.screen.width,
                        display: &#x27;block&#x27;
                    }).appendTo(this.$el);
                this._apps[id] = {
                    $el: iframe,
                    el: iframe[0],
                    window: iframe[0].contentWindow
                };
            }

            this._active = false;
            this.trigger(EVN_APP_NAV, data);

            return this;
        },
        &#x2F;**
         通过ID获取某一个app

            app.getApp(&#x27;hongbao&#x27;);

         @method getApp
         @param {String} id app&#x27;s id
         @return {Object} app: {HTMLElement} app.el the iframe of app; {Node} app.$el the iframe of app; {HTMLElement} app.window the contentWindow of iframe
         **&#x2F;
        getApp: function(id){
            return this._apps[id];
        },
        &#x2F;**
         页面跳转

             app.navPage(&#x27;DetailPage&#x27;, {
                 title: &#x27;MacBook Air&#x27;,
                 desc: &#x27;...&#x27;
             }, &#x27;sliderRightIn&#x27;, false);

         @method navPage
         @param {String} id page id
         @param {Object} data data for next page
         @param {String} anim animation name, contain:

         *   slideRightIn
         *   slideLeftIn
         *   slideTopIn
         *   slideBottomIn
         *   fadeIn
         *   dissolveIn
         *   popIn &lt;sup&gt;4.0+&lt;&#x2F;sup&gt;
         *   flipLeftIn &lt;sup&gt;4.0+&lt;&#x2F;sup&gt;
         *   flipRightIn &lt;sup&gt;4.0+&lt;&#x2F;sup&gt;
         *   swapLeftIn &lt;sup&gt;4.0+&lt;&#x2F;sup&gt;
         *   swapRightIn &lt;sup&gt;4.0+&lt;&#x2F;sup&gt;
         *   cubeLeftIn &lt;sup&gt;4.0+&lt;&#x2F;sup&gt;
         *   cubeRightIn &lt;sup&gt;4.0+&lt;&#x2F;sup&gt;
         *   flowLeftIn &lt;sup&gt;4.0+&lt;&#x2F;sup&gt;
         *   flowRightIn &lt;sup&gt;4.0+&lt;&#x2F;sup&gt;
         *   turnIn &lt;sup&gt;4.0+&lt;&#x2F;sup&gt;

         include the animation css in your less file like this:
         &lt;pre class=&quot;code&quot;&gt;&lt;code&gt;@import &lt;span class=&quot;str&quot;&gt;&quot;easytouch&#x2F;less&#x2F;anim.less&quot;&lt;&#x2F;span&gt;;
         &lt;span class=&quot;com&quot;&gt;
         &#x2F;&#x2F;Notice: When the slideRightIn included, the slideLeftOut is also ready.
         &#x2F;&#x2F;The same, when you include slideLeftOut, slideRightIn is ready too.
         &#x2F;&#x2F;All the animation function has two options: &quot;duration&quot; and &quot;function&quot;.&lt;&#x2F;span&gt;
         &lt;span style=&quot;color:#30418C&quot;&gt;.easytouch&lt;&#x2F;span&gt; &gt; &lt;span style=&quot;color:#30418C&quot;&gt;.anim-slideRightIn&lt;&#x2F;span&gt;(&lt;span class=&quot;lit&quot;&gt;.6&lt;&#x2F;span&gt;s, &lt;span class=&quot;str&quot;&gt;ease-in&lt;&#x2F;span&gt;);
         &lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;

         @param {Boolean} ifPushToHistory if push the page to history, default: &#x60;true&#x60;
         @chainable
         **&#x2F;
        navPage: function(id, data, anim, ifPushToHistory){
            if(!this.pages[id]){
                console.log(&#x27;[EasyTouch] navPage&#x27;, id + &#x27; is not exist.&#x27;);
                return this;
            }

            console.log(&#x27;[EasyTouch] navPage&#x27;, arguments);

            anim = anim || this.defaultAnimation;

            var _this = this,
                argus = [id, data, anim, ifPushToHistory],
                currentPage = this.getCurrentPage(),
                _data = $.extend({}, data),
                pushHistory = function(id, data, anim, ifPushToHistory){
                    if(ifPushToHistory === false){
                        return;
                    }
                    _this.history.push({
                        id: id,
                        data: data,
                        anim: anim
                    });
                };
            if(currentPage &amp;&amp; currentPage.id === id){
                currentPage.trigger(EVN_PAGE_RESET, _data);
                pushHistory.apply(_this, argus);
                return this;
            }

            var eventArgus = {
                    from: currentPage?currentPage.id:undefined,
                    to: id,
                    data: data,
                    anim: anim
                },
                trigger = function(fromPage, toPage){
                    pushHistory.apply(_this, argus);
                    fromPage &amp;&amp; fromPage.trigger(EVN_PAGE_LEAVE);
                    toPage.trigger(EVN_PAGE_READY, data);
                    _this.trigger(EVN_APP_PAGE_NAV, eventArgus);
                    _this.trigger(EVN_APP_PAGE_CHANGE, eventArgus);
                };
            this.trigger(EVN_APP_BEFORE_PAGE_NAV, eventArgus);
            this.trigger(EVN_APP_PAGE_BEFORE_CHANGE, eventArgus);
            if(!this._pages[id]){
                _this._createPage(id, _data, function(page){
                    _this._transitionPages(currentPage, page, data, anim, trigger);
                });
            }else{
                this._pages[id].trigger(EVN_PAGE_RESET, _data);
                _this._transitionPages(currentPage, this._pages[id], data, anim, function(fromPage, toPage){
                    trigger.apply(_this, arguments);
                });
            }

            return this;
        },
        &#x2F;**
         返回到上一个页面

             app.pageBack({
                id: xxx
             }, &#x27;popIn&#x27;);

         @method pageBack
         @param {Object} data data for next page
         @param {String} anim animation name, as same as &#x60;app.navPage&#x60;
         @chainable
         **&#x2F;
        pageBack: function(data, anim){
            console.log(&#x27;[EasyTouch] pageBack&#x27;, arguments);
            if(this._history.length &lt;= 1){
                this.exit();
                return this;
            }

            var _this = this,
                _data,
                currentPage = _this.getCurrentPage(),
                preRecord = this._history[this._history.length - 2],
                lastRecord = this._history[this._history.length - 1],
                id = preRecord.id,
                eventArgus,
                trigger = function(fromPage, toPage){
                    _this.history.pop();
                    fromPage.trigger(EVN_PAGE_LEAVE);
                    toPage.trigger(EVN_PAGE_READY, data);
                    _this.trigger(EVN_APP_PAGE_BACK, eventArgus);
                    _this.trigger(EVN_APP_PAGE_CHANGE, eventArgus);
                };

            &#x2F;&#x2F;如果没有初始化过该页面，说明来至单页面刷新，获取缓存中的data
            data = (this._pages[id] ? data : preRecord.data) || {};
            anim = anim || lastRecord.anim;
            anim = anim?reverseAnimation(anim, &#x2F;Left|Right|Top|Bottom&#x2F;g):null;
            eventArgus = {
                from: lastRecord.id,
                to: preRecord.id,
                data: data,
                anim: anim
            };

            this.trigger(EVN_APP_PAGE_BEFORE_BACK, eventArgus);
            this.trigger(EVN_APP_PAGE_BEFORE_CHANGE, eventArgus);

            _data = $.extend({}, data);
            if(!this._pages[id]){
                this._createPage(id, _data, function(page){
                    _this._transitionPages(currentPage, page, data, anim, trigger);
                });
            }else{
                this._pages[id].trigger(EVN_PAGE_RESET, _data);
                this._transitionPages(currentPage, this._pages[id], data, anim, function(fromPage, toPage){
                    trigger.apply(_this, arguments);
                });
            }

            return this;
        },
        &#x2F;**
         * 页面切换效果
         * @method _transitionPages
         * @param {Object} fromPage
         * @param {Object} toPage
         * @param {String} anim animation name
         * @param {Function} callback
         * @private
         * @chainable
         *&#x2F;
        _transitionPages: function(fromPage, toPage, data, anim, callback){
            var _this = this;

            &#x2F;&#x2F; Collapse the keyboard
&#x2F;&#x2F;            if (document.activeElement &amp;&amp; document.activeElement.nodeName.toLowerCase() !== &#x27;body&#x27;) {
&#x2F;&#x2F;                $(document.activeElement).blur();
&#x2F;&#x2F;            } else {
&#x2F;&#x2F;                $( &quot;:focus&quot; ).blur();
&#x2F;&#x2F;            }

            var $toPage = toPage.$el;
            if(!fromPage){
                this.$el.find(&#x27;.&#x27; + CLASS_PREFIX + &#x27;page&#x27;).removeClass(&#x27;current&#x27;); &#x2F;&#x2F;TODO: 但页面刷新时，需要隐藏页面上写死的Page
                $toPage.addClass(&#x27;current&#x27;);
                callback &amp;&amp; callback(fromPage, toPage);
                return this;
            }
            var $fromPage = fromPage.$el;
            if(anim){
                anim = CLASS_PREFIX + anim;
                var reverseClass = reverseAnimation(anim);
                $toPage.bind(&#x27;webkitAnimationEnd&#x27;, function(){
                    $toPage.unbind(&#x27;webkitAnimationEnd&#x27;).removeClass(anim);
                    setTimeout(function(){
                        callback &amp;&amp; callback(fromPage, toPage);
                        _this.$el.removeClass(&#x27;animating&#x27;);
                    }, TIME_WAIT_FOR_ANIMATION)
                });
                $fromPage.bind(&#x27;webkitAnimationEnd&#x27;, function(){
                    $fromPage.unbind(&#x27;webkitAnimationEnd&#x27;).removeClass(reverseClass+&#x27; current&#x27;);
                });
                this.$el.addClass(&#x27;animating&#x27;);
                $fromPage.addClass(reverseClass);
                $toPage.addClass(anim + &#x27; current&#x27;);
            }else{
                $fromPage.removeClass(&#x27;current&#x27;);
                $toPage.addClass(&#x27;current&#x27;);
                callback &amp;&amp; callback(fromPage, toPage);
            }

            return this;
        },
        &#x2F;**
         * 初始化一个Page类
         * @method _createPage
         * @param {String} id page id
         * @param {Object} data data for next page
         * @param {Function} callback
         * @private
         * @chainable
         *&#x2F;
        _createPage: function(id, data, callback){
            if(typeof this.pages[id] !== &#x27;function&#x27;){
                this.pages[id] = $.EasyTouch.Page.extend(this.pages[id]);
            }
            this._pages[id] = new this.pages[id]({
                id: id,
                data: data,
                app: this
            });

            if(!callback){
                return this;
            }
            if(this._pages[id]._inited){
                callback(this._pages[id])
            }else{
                this._pages[id].bind(EVN_PAGE_INIT, function(){
                    callback(this);
                });
            }

            return this;
        },
        &#x2F;**
         向App添加一个页面

             app.addPage(&#x27;DetailPage&#x27;, {
                html: &#x27;#DetailPage&#x27;
             });

         @method addPage
         @param id page id
         @param {String|Object} options 参数与调用&#x60;$.EasyTouch.Page.extend&#x60;时一致，内部会调用该方法扩展一个Page类
         @chainable
         **&#x2F;
        addPage: function(id, options){
            this.pages[id] = options;
            return this;
        },
        &#x2F;**
         从App移除一个页面，该方法只会从app的实例中删除对该Page的引用

            app.removePage(&#x27;DetailPage&#x27;);

         @method removePage
         @param id page id
         @chainable
         **&#x2F;
        removePage: function(id){
            delete this.pages[id];
            delete this._pages[id];
            this.history.remove(id);
            return this;
        },
        &#x2F;**
         销毁一个页面，该方法不但会从app的实例中删除对该Page的引用，也会调用该page的&#x60;destroy&#x60;方法，完全删除页面

            app.destroyPage(&#x27;DetailPage&#x27;);

         @method destroyPage
         @param id page id
         @chainable
         **&#x2F;
        destroyPage: function(id){
            this._pages[id] &amp;&amp; this._pages[id].destroy();
            return this;
        },
        &#x2F;**
         通过页面ID获取某一个页面的引用

            app.getPage(&#x27;DetailPage&#x27;);

         @method getPage
         @param {String} id page id
         @return {Object} the instance of page
         **&#x2F;
        getPage: function(id){
            return this._pages[id];
        },
        &#x2F;**
         * 获取当前页面的引用
         * @method getCurrentPage
         * @return {Object} the instance of page
         *&#x2F;
        getCurrentPage: function(){
            return this._history.length?this._pages[this._history[this._history.length - 1].id]:null;
        },
        &#x2F;**
         * 获取当前页面的ID
         * @method getCurrentPID
         * @return {String} the page id
         *&#x2F;
        getCurrentPID: function(){
            return this._history.length?this._history[this._history.length - 1].id:null;
        },
        history: function(){
            var _this = this,
                useHistory,
                storageKey = _this.id + &#x27;:&#x27; + SESSION_HISTORY;
            if(sessionStorage.getItem(storageKey)){
                this._history = JSON.parse(sessionStorage.getItem(storageKey));
            }
            return {
                &#x2F;**
                 启用单页面刷新功能, 并开始记录页面跳转, 如果存在历史记录, 则跳转至最后一条历史记录, 反之跳转至options中指定的页面

                     app.history.start({
                         id: &#x27;IndexPage&#x27;,
                         data: {
                            name: &#x27;YouXiao&#x27;
                         }
                     })

                 @method history.start
                 @param {Object} options data to call navPage when the history is empty
                 @param {String} options.id page id
                 @param {Object} options.data data for the default page
                 **&#x2F;
                start: function(options){
                    useHistory = true;
                    if(_this._history.length){
                        var record = _this._history[_this._history.length - 1];
                        _this.navPage(record.id, record.data);
                    }else{
                        _this.navPage(options.id, options.data);
                    }
                },
                &#x2F;**
                 * 从尾部删除一条历史记录,并写入&#x60;sessionStorage&#x60;
                 * @method history.pop
                 * @private
                 *&#x2F;
                pop: function(){
                    _this._history.pop();
                    _this.history.save();
                },
                &#x2F;**
                 * 从历史记录中移除某一id的数据,并写入&#x60;sessionStorage&#x60;
                 * @method history.remove
                 * @private
                 *&#x2F;
                remove: function(id){
                    _this._history = _this._history.filter(function(item){
                        return item.id !== id;
                    });
                    _this.history.save();
                },
                &#x2F;**
                 * 增加一条历史记录,并写入&#x60;sessionStorage&#x60;
                 * @method history.add
                 * @param {Object} record
                 *      @param {String} record.id page id
                 *      @param {Object} record.data data for navPage
                 *      @param {String} record.anim the animation name
                 * @private
                 *&#x2F;
                push: function(record){
                    var lastPID = _this.getCurrentPID(),
                        firstPID = _this._history.length &amp;&amp; _this._history[0].id;
                    if(record.id !== lastPID &amp;&amp; record.id !== firstPID){
                        _this._history.push(record);
                    }else if(record.id === lastPID){
                        &#x2F;&#x2F;相等时，仅更新data参数
                        _this._history[_this._history.length - 1].data = record.data;
                    }else if(record.id === firstPID){
                        _this._history = [record];
                    }
                    _this.history.save();
                },
                &#x2F;**
                 * 将内存中的历史记录写入&#x60;sessionStorage&#x60;
                 * @method history.save
                 * @private
                 *&#x2F;
                save: function(){
                    if(!useHistory){
                        return;
                    }
                    sessionStorage.setItem(storageKey, JSON.stringify(_this._history));
                }
            }
        }
        &#x2F;**
         * 在APP容器中显示加载中提示
         * @method showLoading
         * @param {Object} options
         *      @param {String} options.msg 需要显示的文案
         *      @param {Boolean} options.modal 加载中提示是否覆盖住应用禁止操作
         * @chainable
         *&#x2F;
        &#x2F;**
         * 隐藏APP容器中的加载中提示
         * @method hideLoading
         * @chainable
         *&#x2F;
        &#x2F;**
         * 绑定事件，建议使用更方便的配置&#x60;events&#x60;属性的方式
         *
         *      view.delegateEvents({
         *          &#x27;#contariner&#x27;: {
         *              tap: function(){}
         *          }
         *      });
         *
         * @method delegateEvents
         * @param {Object} events
         * @chainable
         *&#x2F;
        &#x2F;**
         * 解绑所有事件
         * @method undelegateEvents
         * @chainable
         *&#x2F;
    },{
    },{
        &#x2F;**
         通过该方法来继承并扩展一个&#x60;$.EasyTouch&#x60;

             var App = $.EasyTouch.extend({
                 id: &#x27;market&#x27;,
                 container: &#x27;#app&#x27;,
                 ifShowLoading: false,
                 defaultAnimation: &#x27;slideRightIn&#x27;,
                 debug: true,
                 pages: {},
                 apps: {
                    &#x27;hongbao&#x27;: &#x27;http:&#x2F;&#x2F;cloudappfile.aliapp.com&#x2F;prod&#x2F;app_4&#x2F;7184_b6b&#x2F;hongbao&#x2F;&#x27;
                 },
                 events: {
                     &#x27;tap header&#x27;: &#x27;tapHeader&#x27;,
                     &#x27;tap .back&#x27;: this.app.pageBack
                 },
                 &#x2F;&#x2F;this function will run when creating instance
                 init: function(data){},
                 &#x2F;&#x2F;for YunOS resume event
                 resume: function(){},
                 &#x2F;&#x2F;for YunOS suspend event
                 pause: function(){}
             });
             new App();

         @method extend
         @param {Object} property 需要扩展的属性列表
         @param {String} property.id 应用ID，用于EasyTouch内部识别
         @param {Node|HTMLElement|String} property.container 应用容器，默认为&#x60;body&#x60;
         @param {Boolean} property.ifShowLoading 页面加载过程是否显示加载中的提示，默认为&#x60;true&#x60;
         @param {String} property.defaultAnimation 默认的页面切换效果，默认为&#x60;undefined&#x60;
         @param {Boolean} property.debug debug模式开关，默认为&#x60;false&#x60;
         @param {Object} property.pages 页面配置：
         如果是一个Object，EasyTouch会调用&#x60;$.EasyTouch.Page.extend&#x60;，将这个Object作为prototype属性扩展出一个Page，具体请看&#x60;$.EasyTouch.Page.extend&#x60;；
         如果是一个&#x60;$.EasyTouch.Page.extend&#x60;产生的Class，则将直接使用该类作为一个Page；
         @param {Object} property.apps 子应用配置：key为应用的id，value为应用的访问地址，子应用将作为一个iframe的形式存在
         @return {Function} the new Class extended from &#x60;$.EasyTouch&#x60;
         @static
         **&#x2F;
        extend: function(property){
            property.super = $.EasyTouch.prototype;
            var child = $.Base.extend(&#x27;&#x27;, this, property);
            child.extend = this.extend;
            return child;
        }
    });
    $.extend($.EasyTouch.prototype, DelegateEvents.prototype);
    $.extend($.EasyTouch.prototype, Loading.prototype);

    &#x2F;**
     * EasyTouch的子模块Page
     *
     * @module EasyTouch
     * @submodule EasyTouch-Page
     *&#x2F;

    &#x2F;**
     页面类，该类不需要应用自己实例化，EasyTouch会在&#x60;app.navPage&#x60;时判断是否实例化了该页面，如果没有会自动实例化，你需要做的就是用&#x60;$.EasyTouch.Page.extend&#x60;方法扩展一个Page类，然后配置到APP中：

         var Page1 = $.EasyTouch.Page.extend({
             html: &#x27;#xxx .xxx&#x27;,
             &#x2F;&#x2F;tpl: &#x27;&#x27;,
             events: {
                ...
             },
             init: function(){},
             reset: function(){}
                ...
         });
         var App = $.EasyTouch.extend({
             pages: {
                &#x27;Page1&#x27;: Page1
             }
             ...
         });
         new App();

     @class $.EasyTouch.Page
     @extends $.Base
     @param {Object} options
     @param {String} options.id page id
     @param {Object} options.data property add to &#x60;$.EasyTouch.Page&#x60;
     @param {Object} options.app the instance of &#x60;$.EasyTouch&#x60;, the page is in which app
     @constructor
     **&#x2F;
    var
    &#x2F;**
     页面第一次被访问前会促发该事件，&#x60;page.init&#x60;执行前
     @event pagebeforeinit
     @param {Object} e event object from custom-event
     @param {Object} data the data from &#x60;app.navPage&#x60;
     @private
     **&#x2F;
    EVN_PAGE_BEFORE_INIT = &#x27;pagebeforeinit&#x27;,
    &#x2F;**
     页面第一次被访问时会促发该事件，&#x60;page.init&#x60;执行后
     @event pageinit
     @param {Object} e event object from custom-event
     @param {Object} data the data from &#x60;app.navPage&#x60;
     @private
     **&#x2F;
    EVN_PAGE_INIT = &#x27;pageinit&#x27;,
    &#x2F;**
     除了第一次初始化时,页面每一次被访问时都会促发该事件
     @event pagereset
     @param {Object} e event object from custom-event
     @param {Object} data the data from &#x60;app.navPage&#x60;
     **&#x2F;
    EVN_PAGE_RESET = &#x27;pagereset&#x27;,
    &#x2F;**
     每一次离开页面后促发该事件
     @event pageleave
     **&#x2F;
    EVN_PAGE_LEAVE = &#x27;pageleave&#x27;,
    &#x2F;**
     页面每一次页面完全切换完成(初始化完成,动画完成)都会执行该方法
     @event pageready
     @param {Object} e event object from custom-event
     @param {Object} data the data from &#x60;app.navPage&#x60; or &#x60;app.pageBack&#x60;
     **&#x2F;
    EVN_PAGE_READY = &#x27;pageready&#x27;;
    $.EasyTouch.Page = $.Base.build(&#x27;$.EasyTouch.Page&#x27;, {
        &#x2F;**
         * [需要重写]&#x60;html&#x60;和&#x60;tpl&#x60;属性二选一，&#x60;html&#x60;将一段HTML作为一个页面，它可以来至：原生的dom节点、Zepto对象、选择器、一个本地或远程的html文件（如http:&#x2F;&#x2F;xxx.com&#x2F;xxx.html）
         * @property html
         * @type HTMLElement|Node|String
         * @optional
         *&#x2F;
        html: undefined,
        &#x2F;**
         * [需要重写]将一个模板作为一个页面，它可以是：原生的dom节点、Zepto对象、选择器、一个本地或远程的html文件（如tpl&#x2F;xxx.html），对于前三者，EasyTouch会将它们的&#x60;innerHTML&#x60;作为模板，可以在&#x60;page.render&#x60;方法中使用任意模板引擎渲染改模板
         * @property tpl
         * @type HTMLElement|Node|String
         * @optional
         *&#x2F;
        tpl: undefined,
        &#x2F;**
         * Page的id，用于&#x60;app.navPage&#x60;等操作时的索引
         * @property id
         * @type String
         *&#x2F;
        id: undefined,
        &#x2F;**
         * [需要重写]代理的事件列表，&#x60;handler&#x60;可是一个字符串也可以是一个&#x60;function&#x60;，当是字符串时，将访问&#x60;this[&#x27;nav&#x27;]&#x60;
         *
         *      {
         *          &#x27;#contariner header&#x27;: {
         *              tap: &#x27;nav
         *          },
         *          &#x27;#contariner&#x27;: {
         *              tap: function(){},
         *          },
         *          &#x2F;&#x2F;当选择器是空的时，为本身
         *          &#x27;&#x27;: function(){
         *              tap: function(){}
         *          }
         *      }
         *
         * @property events
         * @type Object
         * @optional
         *&#x2F;
        events: {},
        &#x2F;**
         * EasyTouch实例，该page所属app的引用
         * @property app
         * @type Object
         *&#x2F;
        app: undefined,
        &#x2F;**
         * Page的dom容器
         * @property el
         * @type HTMLElement
         *&#x2F;
        el: undefined,
        &#x2F;**
         * Page的$dom容器
         * @property $el
         * @type Node
         *&#x2F;
        $el: undefined,
        &#x2F;**
         * 标识该page是否已经初始化完成
         * @property _inited
         * @type Boolean
         * @default false
         * @private
         *&#x2F;
        _inited: false,
        &#x2F;**
         * 对&#x60;$.EasyTouch.Page.prototype&#x60;的引用
         * @property super
         * @type Object
         *&#x2F;

        initializer: function(options){
            console.log(&#x27;[EasyTouch.Page] &#x27;+options.id+&#x27; initializer&#x27;, arguments);

            this.app = options.app;
            var _this = this,
                data = options.data,
                eventParams = {
                    id: options.id,
                    data: $.extend({}, data)
                },
                init = function(el){
                    el.attr(&#x27;id&#x27;, options.id);
                    el.addClass(CLASS_PREFIX + &#x27;page&#x27;);
                    _this.app.$el.append(el);
                    _this.id = options.id;
                    _this.$el = el;
                    _this.el = _this.$el[0];
                    setTimeout(function(){
                        _this.delegateEvents(_this.events);
                        _this.trigger(EVN_PAGE_BEFORE_INIT, $.extend({}, data));
                        _this.init($.extend({}, data));
                        _this._inited = true;
                        _this.trigger(EVN_PAGE_INIT, $.extend({}, data));
                    }, TIME_WAIT_FOR_RENDER);
                };

            this.bind(EVN_PAGE_RESET, function(e, data){
                _this.reset(data);
            });
            this.bind(EVN_PAGE_LEAVE, function(e){
                _this.leave();
            });
            this.bind(EVN_PAGE_READY, function(e, data){
                _this.ready(data);
            });

            if(this.html){
                &#x2F;&#x2F;xx.html
                if(REGEX_HTML_ADRESS.test(this.html)){
                    this.app.trigger(EVN_APP_BEFORE_PAGE_LOAD, eventParams);
                    $.ajax({
                        url: this.html,
                        success: function(response){
                            _this.app.trigger(EVN_APP_PAGE_LOAD, eventParams);
                            init($(response));
                        },
                        error: function(){
                            _this.app.trigger(EVN_APP_PAGE_LOAD_ERROR, eventParams);
                        }
                    });
                    &#x2F;&#x2F;div &#x2F; &lt;div&gt;xxx&lt;&#x2F;div&gt; &#x2F; document.getElementsByTagName(&#x27;div&#x27;)[0]
                }else if(typeof this.html === &#x27;string&#x27; || this.html.tagName){
                    init($(this.html));
                    &#x2F;&#x2F;$(&#x27;div&#x27;)
                }else{
                    init(this.html);
                }
            }else if(this.tpl){
                &#x2F;&#x2F;xxx.html
                if(REGEX_HTML_ADRESS.test(this.tpl)){
                    this.app.trigger(EVN_APP_BEFORE_PAGE_LOAD, eventParams);
                    $.ajax({
                        url: this.tpl,
                        success: function(response){
                            _this.app.trigger(EVN_APP_PAGE_LOAD, eventParams);
                            response = _this.render(response, data);
                            init($(response));
                        },
                        error: function(){
                            _this.app.trigger(EVN_APP_PAGE_LOAD_ERROR, eventParams);
                        }
                    });
                &#x2F;&#x2F;div &#x2F; document.getElementsByTagName(&#x27;div&#x27;)[0]
                }else if(REGEX_SELECTOR.test(this.tpl) || this.tpl.tagName){
                    init($(_this.render($(this.tpl).html(), data)));
                &#x2F;&#x2F;$(&#x27;div&#x27;) zepto is $.zepto.Z &#x2F; jquery is $
                }else if(this.tpl instanceof $ || this.tpl instanceof $.zepto.Z){
                    init($(_this.render(this.tpl.html(), data)));
                &#x2F;&#x2F;&lt;div&gt;{{content}}&lt;&#x2F;div&gt;
                }else{
                    init($(_this.render(this.tpl, data)));
                }
            }else{
                console.error(&#x27;html or tpl is require&#x27;);
            }
        },
        &#x2F;**
         * 当页面作为一个模板被加入App前,可以通过该方法渲染模板,默认原样返回
         * @method render
         * @param {String} template the html before render
         * @param {Object} data the data from &#x60;app.navPage&#x60;
         * @return {String} the html after render
         *&#x2F;
        render: function(template, data){
            console.log(&#x27;[EasyTouch.Page] render&#x27;);
            return template;
        },
        &#x2F;**
         * 页面第一次被访问时会执行该方法
         * @method init
         * @param {Object} data the data from &#x60;app.navPage&#x60;
         *&#x2F;
        init: function(data){
            console.log(&#x27;[EasyTouch.Page] &#x27;+this.id+&#x27; init&#x27;, arguments);
        },
        &#x2F;**
         * 除了第一次初始化时,页面每一次被访问时都会执行该方法,
         * 初始化时如果需要执行reset方法,请自行在init方法中调用
         * @method reset
         * @param {Object} data the data from &#x60;app.navPage&#x60; or &#x60;app.pageBack&#x60;
         *&#x2F;
        reset: function(data){
            console.log(&#x27;[EasyTouch.Page] &#x27;+this.id+&#x27; reset&#x27;, arguments);
        },
        &#x2F;**
         * 页面每一次页面完全切换完成都会执行该方法
         * @method ready
         * @param {Object} data the data from &#x60;app.navPage&#x60; or &#x60;app.pageBack&#x60;
         *&#x2F;
        ready: function(data){
            console.log(&#x27;[EasyTouch.Page] &#x27;+this.id+&#x27; ready&#x27;, arguments);
        },
        &#x2F;**
         * 每一次离开页面后执行该方法
         * @method leave
         *&#x2F;
        leave: function(){
            console.log(&#x27;[EasyTouch.Page] &#x27;+this.id+&#x27; leave&#x27;);
        },
        &#x2F;**
         * 销毁该页面
         * @method destroy
         *&#x2F;
        destroy: function(){
            this.undelegateEvents();
            this.app.removePage(this.id);
            this.$el.remove();
        }
        &#x2F;**
         * 在当前页面显示加载中提示
         * @method showLoading
         * @param {Object} options
         *      @param {String} options.msg 需要显示的文案
         *      @param {Boolean} options.modal 加载中提示是否覆盖住应用禁止操作
         * @chainable
         *&#x2F;
        &#x2F;**
         * 隐藏当前页面中的加载中提示
         * @method hideLoading
         * @chainable
         *&#x2F;
        &#x2F;**
         * 绑定事件，建议使用更方便的配置&#x60;events&#x60;属性的方式
         *
         *      view.delegateEvents({
         *          &#x27;#contariner&#x27;: {
         *              tap: function(){}
         *          }
         *      });
         *
         * @method delegateEvents
         * @param {Object} events
         * @chainable
         *&#x2F;
        &#x2F;**
         * 解绑所有事件
         * @method undelegateEvents
         * @chainable
         *&#x2F;
    },{
        &#x2F;**
         * Page的id，用于&#x60;app.navPage&#x60;等操作时的索引
         * @attribute id
         * @type String
         *&#x2F;
        id: {},
        &#x2F;**
         * EasyTouch实例，该page所属app的引用
         * @attribute app
         * @type Object
         *&#x2F;
        app: {},
        &#x2F;**
         * 传递给page的参数
         * @attribute data
         * @type Object
         *&#x2F;
        data: {}
    },{
        &#x2F;**
         通过该方法来继承并扩展一个&#x60;$.EasyTouch.Page&#x60;：

             var Page1 = $.EasyTouch.Page.extend({
                 &#x2F;&#x2F;set html or tpl property, examples in $.EasyTouch example
                 html: &#x27;#Page1&#x27;,
                 &#x2F;&#x2F;html: document.getElementById(&#x27;#Page1&#x27;),
                 &#x2F;&#x2F;html: $(&#x27;#Page1&#x27;),
                 &#x2F;&#x2F;html: &#x27;pages&#x2F;Page1.html&#x27;,

                 &#x2F;&#x2F;tpl: &#x27;#Page1&#x27;,
                 &#x2F;&#x2F;tpl: document.getElementById(&#x27;#Page1&#x27;),
                 &#x2F;&#x2F;tpl: $(&#x27;#Page1&#x27;),
                 &#x2F;&#x2F;tpl: &#x27;pages&#x2F;Page1.html&#x27;,

                 events: {
                     &#x27;header&#x27;: {
                        tap: &#x27;tapHeader&#x27;,
                     }
                     &#x27;.back&#x27;: {
                        tap: this.app.pageBack
                     }
                 },
                 render: function(template, data){
                     return Mustache.to_html(template, data);
                 },
                 init: function(){

                 },
                 reset: function(){

                 },
                 ready： function(){

                 },
                 leave： function(){

                 },
                 tapHeader: function(e, sender){

                 }
             });

         @method extend
         @param {Object} property property or function add to &#x60;$.EasyTouch.Page&#x60;
         @param {HTMLElement|Node|String} property.html &#x60;html&#x60;和&#x60;tpl&#x60;属性二选一，&#x60;html&#x60;将一个节点作为一个页面，它可以是：原生的dom节点、Zepto对象、选择器、一个本地或远程的html文件（如http:&#x2F;&#x2F;xxx.com&#x2F;xxx.html）
         @param {HTMLElement|Node|String} property.tpl 将一个模板作为一个页面，它可以是：原生的dom节点、Zepto对象、选择器、一个本地或远程的html文件（如tpl&#x2F;xxx.html），对于前三者，EasyTouch会将它们的&#x60;innerHTML&#x60;作为模板，可以在&#x60;page.render&#x60;方法中使用任意模板引擎渲染改模板
         @return {Function} the new Class extended from &#x60;$.EasyTouch.Page&#x60;
         @static
         **&#x2F;
        extend: function(property){
            property.super = $.EasyTouch.Page.prototype;
            var child = $.Base.extend(&#x27;&#x27;, this, property);
            child.extend = this.extend;
            return child;
        }
    });
    $.extend($.EasyTouch.Page.prototype, DelegateEvents.prototype);
    $.extend($.EasyTouch.Page.prototype, Loading.prototype);
})();
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
